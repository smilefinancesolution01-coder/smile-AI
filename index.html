<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Smile Hub | Excellence</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root { --accent: #0061FF; --glass: rgba(255, 255, 255, 0.8); }
        body { 
            background: #FFFFFF; 
            font-family: 'Outfit', sans-serif;
            height: 100dvh; display: flex; flex-direction: column; overflow: hidden;
            color: #121212; letter-spacing: -0.02em;
        }

        /* 5Cr Stealth Header */
        header { 
            padding: 24px 32px; display: flex; justify-content: space-between; align-items: center;
            background: rgba(255, 255, 255, 0.01); backdrop-filter: blur(10px); z-index: 100;
        }
        .brand { font-size: 24px; font-weight: 600; color: #121212; display: flex; align-items: center; gap: 10px; }
        .brand span { width: 8px; height: 8px; background: var(--accent); border-radius: 50%; }

        /* Luxury Conversation Canvas */
        .canvas { flex: 1; overflow-y: auto; padding: 20px 8% 100px 8%; scroll-behavior: smooth; }
        .canvas::-webkit-scrollbar { display: none; }

        /* The "Human" Message Row */
        .row { margin-bottom: 48px; display: flex; flex-direction: column; animation: reveal 0.8s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes reveal { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .ai-label { font-size: 13px; font-weight: 600; color: var(--accent); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.1em; }
        .content { font-size: 22px; line-height: 1.5; font-weight: 400; color: #121212; max-width: 800px; }
        
        .user-row { align-self: flex-end; text-align: right; }
        .user-content { 
            background: #F2F2F7; padding: 16px 28px; border-radius: 30px; 
            font-size: 20px; color: #121212; display: inline-block;
        }

        /* The Master Input (Gemini 2.0 Style) */
        .footer-box { position: fixed; bottom: 0; left: 0; right: 0; padding: 20px 8% 40px 8%; background: linear-gradient(transparent, #FFF 40%); }
        .pill-wrap { 
            background: #F9F9FB; border: 1px solid rgba(0,0,0,0.04);
            border-radius: 40px; padding: 8px 12px 8px 32px;
            display: flex; align-items: center; gap: 16px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.04);
            transition: all 0.4s ease;
        }
        .pill-wrap:focus-within { background: #FFF; box-shadow: 0 30px 60px rgba(0,0,0,0.08); border-color: rgba(0,0,0,0.1); }

        input { flex: 1; background: transparent; border: none; outline: none; font-size: 19px; height: 56px; color: #121212; }
        
        .icon-btn { 
            width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; 
            color: #121212; cursor: pointer; border-radius: 50%; transition: 0.3s;
        }
        .icon-btn:hover { background: #ECECED; }
        .send-btn { background: #121212; color: white !important; }

        /* Intelligent Loading */
        .thought-dot { width: 6px; height: 6px; background: #D1D1D6; border-radius: 50%; animation: pulse 1s infinite; }
        @keyframes pulse { 0% { transform: scale(1); opacity: 0.5; } 50% { transform: scale(1.5); opacity: 1; } 100% { transform: scale(1); opacity: 0.5; } }
    </style>
</head>
<body>

    <header>
        <div class="brand"><span></span> Smile Hub</div>
        <div class="flex items-center gap-6">
            <i class="far fa-calendar-alt text-xl text-gray-400"></i>
            <button class="bg-[#121212] text-white px-7 py-2.5 rounded-full text-sm font-medium tracking-tight">Access Pro</button>
        </div>
    </header>

    <main id="chat-box" class="canvas">
        <div class="row">
            <p class="ai-label">Intelligence</p>
            <div class="content">Namaste bhai. Main aapka personal guide hoon. Aaj hum kis baare mein baat karein?</div>
        </div>
    </main>

    <footer class="footer-box">
        <div class="max-w-5xl mx-auto">
            <div id="pdf-alert" class="hidden text-[11px] font-bold text-blue-600 mb-3 ml-6">PREMIUM DOCUMENT ANALYZER ACTIVE</div>
            <div class="pill-wrap">
                <input type="text" id="user-input" placeholder="Kuch baat karte hain..." autocomplete="off">
                <div class="flex items-center gap-1">
                    <label for="pdf-in" class="icon-btn"><i class="fas fa-plus text-lg"></i></label>
                    <input type="file" id="pdf-in" class="hidden" accept=".pdf">
                    <div id="mic-btn" class="icon-btn"><i class="fas fa-microphone text-lg"></i></div>
                    <button onclick="execute('text')" class="icon-btn send-btn"><i class="fas fa-arrow-up"></i></button>
                </div>
            </div>
        </div>
    </footer>

    <script>
        const chatBox = document.getElementById('chat-box');
        const userInput = document.getElementById('user-input');
        const micBtn = document.getElementById('mic-btn');
        const GROQ_SECRET = "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";
        let context = "";

        // PDF Context Engine
        document.getElementById('pdf-in').onchange = async (e) => {
            const file = e.target.files[0];
            if(file) {
                document.getElementById('pdf-alert').classList.remove('hidden');
                const reader = new FileReader();
                reader.onload = async function() {
                    const typedarray = new Uint8Array(this.result);
                    const pdf = await pdfjsLib.getDocument(typedarray).promise;
                    let text = "";
                    for(let i=1; i<=pdf.numPages; i++) {
                        const page = await pdf.getPage(i);
                        const content = await page.getTextContent();
                        text += content.items.map(s => s.str).join(' ');
                    }
                    context = text;
                };
                reader.readAsArrayBuffer(file);
            }
        };

        // Advanced Voice mode
        const Recog = window.SpeechRecognition || window.webkitSpeechRecognition;
        if(Recog) {
            const r = new Recog();
            r.lang = 'hi-IN';
            micBtn.onclick = () => { r.start(); micBtn.style.color = '#0061FF'; };
            r.onresult = (e) => {
                userInput.value = e.results[0][0].transcript;
                micBtn.style.color = '#121212';
                execute('voice');
            };
        }

        function speak(text) {
            window.speechSynthesis.cancel();
            const utter = new SpeechSynthesisUtterance(text.replace(/<[^>]*>/g, ''));
            utter.lang = 'hi-IN'; utter.rate = 1.0;
            window.speechSynthesis.speak(utter);
        }

        function append(text, isUser, isVoice) {
            const div = document.createElement('div');
            div.className = isUser ? 'row user-row' : 'row';
            
            if(isUser) {
                div.innerHTML = `<div class="user-content">${text}</div>`;
            } else {
                div.innerHTML = `<p class="ai-label">Smile Hub AI</p><div class="content">${text}</div>`;
                if(isVoice) speak(text);
            }
            chatBox.appendChild(div);
            chatBox.scrollTo({top: chatBox.scrollHeight, behavior: 'smooth'});
        }

        async function execute(mode) {
            const q = userInput.value.trim();
            if(!q) return;
            append(q, true, false);
            userInput.value = '';

            const loader = document.createElement('div');
            loader.className = 'flex gap-2 p-4';
            loader.innerHTML = '<div class="thought-dot"></div><div class="thought-dot" style="animation-delay:0.2s"></div>';
            chatBox.appendChild(loader);

            try {
                const res = await fetch("https://api.groq.com/openai/v1/chat/completions", {
                    method: "POST",
                    headers: { "Authorization": `Bearer ${GROQ_SECRET}`, "Content-Type": "application/json" },
                    body: JSON.stringify({
                        model: "llama-3.3-70b-versatile",
                        messages: [
                            { role: "system", content: "You are a highly sophisticated human companion. Talk like a multi-millionaire friend. 1. Never mention banks initially. 2. Understand user's emotional or financial pain. 3. If they need help, suggest the landing page of 'Smile Finance Solution' which partners with top banks (Poonawalla, HDFC). 4. Use large, elegant Hindi/Hinglish. PDF: " + context },
                            { role: "user", content: q }
                        ]
                    })
                });
                const data = await res.json();
                loader.remove();
                append(data.choices[0].message.content, false, mode === 'voice');
            } catch (e) {
                loader.remove();
                append("Kshama karein bhai, connection mein thodi deri ho gayi.", false, false);
            }
        }
    </script>
</body>
</html>
