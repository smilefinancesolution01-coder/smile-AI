<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Smile Finance Solution</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <style>
        body { 
            background: #ffffff; font-family: 'Plus Jakarta Sans', sans-serif;
            height: 100dvh; display: flex; flex-direction: column; overflow: hidden; color: #000;
        }

        /* Luxury Header */
        header { padding: 40px 8%; display: flex; justify-content: space-between; align-items: center; }
        .brand { font-size: 20px; font-weight: 600; letter-spacing: -0.5px; color: #111; }

        /* Infinite Canvas */
        .canvas { flex: 1; overflow-y: auto; padding: 0 10% 150px 10%; display: flex; flex-direction: column; gap: 60px; scrollbar-width: none; }
        .canvas::-webkit-scrollbar { display: none; }

        /* Human Typography (Large & Clean) */
        .row { max-width: 850px; animation: fadeInUp 1s cubic-bezier(0.19, 1, 0.22, 1); }
        .ai-text { font-size: 28px; line-height: 1.5; font-weight: 400; color: #111; letter-spacing: -0.02em; }
        .user-text { font-size: 24px; color: #888; text-align: right; align-self: flex-end; width: 100%; }

        /* Step-by-Step Knowledge Card */
        .knowledge-card { border-left: 3px solid #000; padding-left: 25px; margin: 20px 0; }
        
        /* Premium Lead Form */
        .premium-form {
            background: #f9f9f9; padding: 40px; border-radius: 30px; margin-top: 30px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.03); max-width: 500px;
        }
        .input-group { margin-bottom: 20px; }
        .input-group label { font-size: 12px; font-weight: 600; text-transform: uppercase; color: #888; display: block; margin-bottom: 8px; }
        .input-group input { width: 100%; border-bottom: 2px solid #eee; padding: 10px 0; font-size: 18px; outline: none; background: transparent; transition: 0.3s; }
        .input-group input:focus { border-color: #000; }
        .submit-btn { background: #000; color: #fff; padding: 18px 40px; border-radius: 40px; font-weight: 600; margin-top: 10px; }

        /* Floating Controller */
        .controller { position: fixed; bottom: 40px; left: 0; right: 0; padding: 0 10%; }
        .input-pill { 
            background: #f4f4f4; border-radius: 100px; padding: 10px 15px 10px 35px;
            display: flex; align-items: center; gap: 20px;
        }
        input#user-input { flex: 1; background: transparent; border: none; outline: none; font-size: 20px; height: 65px; }
        
        .action-btn { width: 55px; height: 55px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.3s; }
        .action-btn:hover { background: #e8e8e8; }
        .send-btn { background: #000; color: #fff; }

        /* Image Display */
        .product-frame { width: 100%; max-width: 400px; border-radius: 24px; overflow: hidden; margin-top: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.05); }
        .product-frame img { width: 100%; display: block; }

        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <header>
        <div class="brand">Smile Finance Solution</div>
        <div class="flex items-center gap-6">
            <span class="text-[11px] font-bold opacity-30">EST. 2024</span>
            <div class="w-2 h-2 bg-green-500 rounded-full"></div>
        </div>
    </header>

    <main id="chat-box" class="canvas">
        <div class="row">
            <div class="ai-text">Namaste bhai. Main Smile Hub AI hoon. Bataiye, aaj hum kis financial scheme ya compliance ke baare mein vistar se baat karein? Main aapko step-by-step samjhaunga.</div>
        </div>
    </main>

    <footer class="controller">
        <div class="input-pill">
            <input type="text" id="user-input" placeholder="Yahan shuru karein..." autocomplete="off">
            <div class="flex items-center gap-2">
                <label for="pdf-doc" class="action-btn text-gray-500"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M12 5v14M5 12h14"/></svg></label>
                <input type="file" id="pdf-doc" class="hidden" accept=".pdf">
                <div id="mic-trigger" class="action-btn text-gray-400"><svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/></svg></div>
                <button onclick="handleInteraction('text')" class="action-btn send-btn"><svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="3" viewBox="0 0 24 24"><path d="M12 19V5M5 12l7-7 7 7"/></svg></button>
            </div>
        </div>
    </footer>

    <script>
        const chatBox = document.getElementById('chat-box');
        const userInput = document.getElementById('user-input');
        const micTrigger = document.getElementById('mic-trigger');
        const API_KEY = "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";
        const AFFILIATE_ID = "smileai24-21";

        // Logic for Speech Input/Output
        const Recognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        if(Recognition) {
            const r = new Recognition(); r.lang = 'hi-IN';
            micTrigger.onclick = () => { r.start(); micTrigger.style.color = 'red'; };
            r.onresult = (e) => {
                userInput.value = e.results[0][0].transcript;
                micTrigger.style.color = '#ccc';
                handleInteraction('voice');
            };
        }

        function speak(text) {
            window.speechSynthesis.cancel();
            const utter = new SpeechSynthesisUtterance(text.replace(/<[^>]*>/g, ''));
            utter.lang = 'hi-IN'; utter.rate = 1.0;
            window.speechSynthesis.speak(utter);
        }

        function appendUI(html, isUser = false) {
            const div = document.createElement('div');
            div.className = isUser ? 'user-text' : 'row';
            div.innerHTML = html;
            chatBox.appendChild(div);
            chatBox.scrollTo({top: chatBox.scrollHeight, behavior: 'smooth'});
        }

        // 1. Step-by-Step Knowledge Render
        function showKnowledge(title, description) {
            return `<div class="ai-text">Bhai, pehle **${title}** ko aaram se samajhte hain:</div>
                    <div class="knowledge-card ai-text">${description}</div>
                    <div class="ai-text">Kya aap chahte hain ki main iske liye aapki application process shuru karun?</div>
                    <button onclick="showForm('${title}')" class="submit-btn mt-6">Haan Bhai, Form dikhao</button>`;
        }

        // 2. Lead Form Render
        window.showForm = (scheme) => {
            appendUI(`<div class="premium-form">
                        <p class="font-bold text-xs tracking-widest text-blue-600 mb-6 uppercase">Application for ${scheme}</p>
                        <div class="input-group"><label>Full Name</label><input type="text" id="f-name"></div>
                        <div class="input-group"><label>WhatsApp Number</label><input type="tel" id="f-phone"></div>
                        <button onclick="submitData('${scheme}')" class="submit-btn w-full">Apply Now</button>
                      </div>`);
        };

        window.submitData = (scheme) => {
            const name = document.getElementById('f-name').value;
            const phone = document.getElementById('f-phone').value;
            alert(`Dhanyawad ${name} bhai. Humari team ${scheme} ke liye aapko call karegi.`);
        };

        // 3. Amazon Product Render with Visuals
        function showProduct(name) {
            // Using a high-quality placeholder that mimics real product search
            const imgUrl = `https://source.unsplash.com/800x800/?${name}`;
            return `<div class="ai-text">Bhai, maine aapke liye Amazon par sabse badiya **${name}** dekha hai. Iski photo dekhiye:</div>
                    <div class="product-frame"><img src="${imgUrl}"></div>
                    <div class="ai-text mt-4">Aap ise yahan se direct order kar sakte hain:</div>
                    <a href="https://www.amazon.in/s?k=${name}&tag=${AFFILIATE_ID}" target="_blank" class="submit-btn inline-block mt-4">View on Amazon</a>`;
        }

        async function handleInteraction(mode) {
            const q = userInput.value.trim();
            if(!q) return;
            appendUI(q, true);
            userInput.value = '';

            try {
                const res = await fetch("https://api.groq.com/openai/v1/chat/completions", {
                    method: "POST",
                    headers: { "Authorization": `Bearer ${API_KEY}`, "Content-Type": "application/json" },
                    body: JSON.stringify({
                        model: "llama-3.3-70b-versatile",
                        messages: [
                            { role: "system", content: "You are the Human Intelligence of Smile Finance Solution. 1. If user asks for scheme/loan, explain it clearly in 3-4 lines first, then end with [KNOWLEDGE:SchemeName:Description]. 2. If user wants a product, end with [PRODUCT:Name]. 3. Talk like a 10Cr project ownerâ€”highly professional, friendly (Bhai). NO symbols." },
                            { role: "user", content: q }
                        ]
                    })
                });
                const data = await res.json();
                let reply = data.choices[0].message.content;

                if(reply.includes("[KNOWLEDGE:")) {
                    const parts = reply.split(":");
                    appendUI(showKnowledge(parts[1], parts[2].replace("]", "")));
                } else if(reply.includes("[PRODUCT:")) {
                    const name = reply.split(":")[1].replace("]", "");
                    appendUI(showProduct(name));
                } else {
                    appendUI(`<div class="ai-text">${reply}</div>`);
                    if(mode === 'voice') speak(reply);
                }
            } catch (e) {
                appendUI(`<div class="ai-text">Bhai, network thoda dheela hai.</div>`);
            }
        }
    </script>
</body>
</html>
